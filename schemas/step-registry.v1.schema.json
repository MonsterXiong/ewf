{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://ewf.local/schemas/step-registry.v1.schema.json",
  "title": "EWF Step Registry Schema v1",
  "type": "object",
  "additionalProperties": true,
  "required": ["schemaVersion", "nodes"],
  "properties": {
    "schemaVersion": { "type": "string" },
    "nodes": {
      "type": "array",
      "items": { "$ref": "#/$defs/nodeDef" }
    }
  },
  "$defs": {
    "nodeDef": {
      "type": "object",
      "additionalProperties": true,
      "required": ["type", "typeVersion"],
      "properties": {
        "type": { "type": "string", "minLength": 1 },
        "typeVersion": { "type": "integer", "minimum": 1 },

        "meta": { "type": "object", "additionalProperties": true },
        "ports": { "type": "array", "items": { "type": "object", "additionalProperties": true } },
        "io": { "type": "object", "additionalProperties": true },
        "defaults": { "type": "object", "additionalProperties": true },
        "constraints": { "type": "object", "additionalProperties": true },
        "impl": { "type": "object", "additionalProperties": true },

        "inputs": { "type": "array", "items": { "type": "object", "additionalProperties": true } },
        "outputs": { "type": ["object", "array"], "additionalProperties": true }
      }
    }
  }
}
